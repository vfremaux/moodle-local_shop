{"version":3,"file":"productdetail.min.js","sources":["../src/productdetail.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n// jshint unused: true, undef:true\r\n\r\ndefine(['jquery', 'core/log', 'core/config'], function($, log, cfg) {\r\n\r\n    var shopproductdetail = {\r\n\r\n        init: function() {\r\n            // Binds response to product pass code when defined.\r\n            $('#ci-pass').bind('change', this.check_pass_code);\r\n        },\r\n\r\n        /**\r\n         * Similar to front.js, but single product in page.\r\n         * @param {Object} e - The event\r\n         */\r\n        check_pass_code: function(e) {\r\n\r\n            var that = $(this);\r\n\r\n            var productname = that.attr('data-product');\r\n\r\n            var urlbase = cfg.wwwroot + '/local/shop/front/ajax/service.php';\r\n\r\n            var ajax_waiter_img = '<img width=\"14\" height=\"14\" src=\"' + cfg.wwwroot + '/local/shop/pix/ajaxloader.gif\" />';\r\n            var ajax_success_img = '<img width=\"14\" height=\"14\" src=\"' + cfg.wwwroot + '/local/shop/pix/valid.png\" />';\r\n            var ajax_failure_img = '<img width=\"14\" height=\"14\" src=\"' + cfg.wwwroot + '/local/shop/pix/invalid.png\" />';\r\n\r\n            $('#ci-pass-status-' + productname).html(ajax_waiter_img);\r\n            $('#cimod-pass-status-' + productname).html(ajax_waiter_img);\r\n\r\n            var input = that.val() + e.key;\r\n\r\n            $.post(\r\n                urlbase,\r\n                {\r\n                    service: 'shop',\r\n                    what: 'checkpasscode',\r\n                    productname: productname,\r\n                    passcode: input\r\n                },\r\n                function(data) {\r\n                    var dataobj = JSON.parse(data);\r\n                    if (dataobj.status == 'passed') {\r\n                        $('#ci-add-to-bag').attr('disabled', null);\r\n                        $('#ci-pass-status-' + productname).html(ajax_success_img);\r\n                        $('#cimod-' + productname).attr('disabled', null);\r\n                        $('#cimod-pass-status-' + productname).html(ajax_success_img);\r\n                    } else {\r\n                        $('#ci-add-to-bag').attr('disabled', 'disabled');\r\n                        $('#ci-pass-status-' + productname).html(ajax_failure_img);\r\n                        $('#cimod-pass-status-' + productname).html(ajax_failure_img);\r\n                    }\r\n                },\r\n                'html'\r\n            );\r\n        },\r\n    };\r\n\r\n    return shopproductdetail;\r\n\r\n});"],"names":["define","$","log","cfg","init","bind","this","check_pass_code","e","that","productname","attr","urlbase","wwwroot","ajax_waiter_img","ajax_success_img","ajax_failure_img","html","input","val","key","post","service","what","passcode","data","JSON","parse","status"],"mappings":"AAiBAA,kCAAO,CAAC,SAAU,WAAY,gBAAgB,SAASC,EAAGC,IAAKC,WAEnC,CAEpBC,KAAM,WAEFH,EAAE,YAAYI,KAAK,SAAUC,KAAKC,kBAOtCA,gBAAiB,SAASC,OAElBC,KAAOR,EAAEK,MAETI,YAAcD,KAAKE,KAAK,gBAExBC,QAAUT,IAAIU,QAAU,qCAExBC,gBAAkB,oCAAsCX,IAAIU,QAAU,qCACtEE,iBAAmB,oCAAsCZ,IAAIU,QAAU,gCACvEG,iBAAmB,oCAAsCb,IAAIU,QAAU,kCAE3EZ,EAAE,mBAAqBS,aAAaO,KAAKH,iBACzCb,EAAE,sBAAwBS,aAAaO,KAAKH,qBAExCI,MAAQT,KAAKU,MAAQX,EAAEY,IAE3BnB,EAAEoB,KACET,QACA,CACIU,QAAS,OACTC,KAAM,gBACNb,YAAaA,YACbc,SAAUN,QAEd,SAASO,MAEiB,UADRC,KAAKC,MAAMF,MACbG,QACR3B,EAAE,kBAAkBU,KAAK,WAAY,MACrCV,EAAE,mBAAqBS,aAAaO,KAAKF,kBACzCd,EAAE,UAAYS,aAAaC,KAAK,WAAY,MAC5CV,EAAE,sBAAwBS,aAAaO,KAAKF,oBAE5Cd,EAAE,kBAAkBU,KAAK,WAAY,YACrCV,EAAE,mBAAqBS,aAAaO,KAAKD,kBACzCf,EAAE,sBAAwBS,aAAaO,KAAKD,qBAGpD"}