define("local_shop/editmetadata",["jquery","core/log"],(function($,log){var shopmetadataedit={init:function(){$('input[name="editextradata"]').bind("click",this.openeditmodal),$('input[name="editproductiondata"]').bind("click",this.openeditmodal),$('input[name="edithandlerparams"]').bind("click",this.openeditmodal),log.debug("Local Shop AMD Editmetadata Initialized !")},parsevalues:function(values,format){var arr,part,parts,valuearr=[];if("json"===format)valuearr=JSON.parse(values);else for(part in parts=values.split("&"))valuearr[(arr=parts[part].split("="))[0]]=arr[1];return valuearr},recombinevalues:function(values,format){var val,valueparts=[];if("json"===format)return JSON.stringify(values);for(val in values)valueparts.push(val+"="+values[val]);return valueparts.join("&")},openeditmodal:function(e){e.stopPropagation(),e.preventDefault(),log.debug("Opening modal for metadatas.");var row,rowname,rowinput,closebtn,valkey,that=$(this),theform=$("#metadata-edit-modal-form"),themodal=$("#metadata-edit-modal-container"),associatedtextarea=$("[data-edithandle="+that.attr("id")+"]"),format=associatedtextarea.attr("data-format"),values=shopmetadataedit.parsevalues(associatedtextarea.val(),format);for(valkey in log.debug("Detected format is "+format+"."),values)row=$("<div/>",{class:"mtd-row"}),rowname=$('<div class="mtd-name">'+valkey+"</div>"),(rowinput=$("<div/>")).append($("<input/>",{type:"text",size:80,value:values[valkey],placeholder:valkey,name:valkey})),row.append(rowname).append(rowinput),theform.append(row);row=$("<div/>",{class:"mtd-row"}),(rowname=$("<div/>")).append($("<input/>",{type:"text",value:"",placeholder:"New key",name:"newkey"})),(rowinput=$("<div/>")).append($("<input/>",{type:"text",value:"",size:80,placeholder:"New value",name:"newval"})),row.append(rowname).append(rowinput),theform.append(row),row=$("<div/>",{class:"mtd-row"}),(closebtn=$("<div/>")).append($("<input/>",{type:"button",id:"mtd-close",value:"Save","data-format":format,"data-for":associatedtextarea.attr("id"),class:"btn btn-primary"})),closebtn.append($("<input/>",{type:"button",id:"mtd-cancel",value:"Cancel","data-format":format,"data-for":associatedtextarea.attr("id"),class:"btn btn-primary"})),row.append($("<div/>")).append(closebtn),theform.append(row),$("#mtd-close").bind("click",shopmetadataedit.closeeditmodal),$("#mtd-cancel").bind("click",shopmetadataedit.canceleditmodal),themodal.css("display","block")},canceleditmodal:function(e){var themodal=$("#metadata-edit-modal-container"),theform=$("#metadata-edit-modal-form");e.stopPropagation(),e.preventDefault(),theform.empty(),themodal.css("display","none")},closeeditmodal:function(e){e.stopPropagation(),e.preventDefault();var valuebuf,newkey,newval,that=$(this),themodal=$("#metadata-edit-modal-container"),theform=$("#metadata-edit-modal-form"),format=that.attr("data-format"),inputs=$('input[type="text"]',theform);valuebuf=new Object,inputs.each((function(){"newkey"===$(this).attr("name")?newkey=$(this).val():"newval"===$(this).attr("name")?newval=$(this).val():valuebuf[$(this).attr("name")]=$(this).val()})),newkey&&(valuebuf[newkey]=newval),$("#"+that.attr("data-for")).val(shopmetadataedit.recombinevalues(valuebuf,format)),theform.empty(),themodal.css("display","none")}};return shopmetadataedit}));

//# sourceMappingURL=editmetadata.min.js.map