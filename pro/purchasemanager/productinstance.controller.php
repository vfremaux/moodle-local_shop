<?php
/*   __________________________________________________
    |              on 2.0.12              |
    |__________________________________________________|
*/
 namespace local_shop\backoffice; defined("\115\x4f\117\104\114\x45\x5f\x49\116\x54\105\x52\x4e\x41\114") || die; require_once $CFG->dirroot . "\57\154\x6f\x63\x61\x6c\x2f\163\150\x6f\160\57\x63\154\141\163\163\145\x73\57\x43\x75\x73\164\x6f\x6d\x65\162\56\x63\x6c\x61\x73\163\x2e\x70\150\x70"; require_once $CFG->dirroot . "\57\154\157\x63\141\154\57\163\x68\x6f\160\x2f\x63\x6c\x61\163\x73\145\x73\57\102\151\154\x6c\56\x63\x6c\x61\163\x73\56\160\150\x70"; require_once $CFG->dirroot . "\x2f\154\x6f\143\141\x6c\x2f\x73\150\x6f\x70\57\143\154\141\163\163\x65\163\57\103\141\x74\141\x6c\x6f\x67\111\x74\x65\155\x2e\143\x6c\141\x73\163\x2e\160\x68\160"; require_once $CFG->dirroot . "\57\154\x6f\x63\141\x6c\x2f\163\150\x6f\160\x2f\143\x6c\x61\x73\163\x65\163\x2f\120\162\x6f\144\x75\143\164\x2e\x63\x6c\141\x73\163\56\160\x68\160"; require_once $CFG->dirroot . "\x2f\x6c\157\x63\x61\154\57\x73\x68\157\160\57\143\x6c\141\x73\163\x65\x73\x2f\x50\x72\x6f\144\165\x63\164\105\166\145\x6e\x74\56\143\x6c\141\163\x73\56\160\150\160"; use StdClass; use local_shop\Customer; use local_shop\Bill; use local_shop\CatalogItem; use local_shop\Product; use local_shop\ProductEvent; class product_instance_controller { protected $data; protected $received; public function receive($bLyFn, $lWyz5 = null) { goto fBduf; PYDj8: return; goto bVgY3; SUlpx: $this->received = true; goto PYDj8; NIRTk: $this->data = new \StdClass(); goto H4N4V; qqEs_: $this->received = true; goto aZ5tY; kcKqL: $this->data = (object) $lWyz5; goto SUlpx; fBduf: if (!empty($lWyz5)) { goto BT9bD; } goto NIRTk; evOke: BT9bD: goto kcKqL; txyNJ: e7_Tr: goto qqEs_; Z1XRG: switch ($bLyFn) { case "\x64\145\x6c\145\164\145": case "\163\x6f\x66\x74\144\145\x6c\145\164\x65": case "\x73\x6f\x66\164\x72\x65\163\x74\157\x72\x65": $this->data->set = required_param_array("\163\145\164", PARAM_INT); goto e7_Tr; case "\141\154\x69\x67\x6e\x73\164\141\162\164\144\141\x74\145": case "\141\154\x69\147\x6e\x65\x6e\x64\144\141\x74\145": case "\x61\154\x69\x67\x6e\x68\x6f\163\x74": case "\x61\x6c\151\x67\x6e\x6f\164\150\145\x72\x68\157\163\x74\163": case "\141\x6c\x69\147\x6e\x6d\x65\x74\x61\144\x61\x74\141": case "\x65\x64\151\x74": goto e7_Tr; } goto TaeM8; H4N4V: goto bXyTF; goto evOke; TaeM8: mDg7i: goto txyNJ; bVgY3: bXyTF: goto Z1XRG; aZ5tY: } public function process($bLyFn) { goto CC2nV; lytw2: $Kl6Lw->billitemid = $this->data->currentbillitemid; goto zKo8M; pu9g9: cA7Lc: goto BJjCJ; BJGGe: aEs_6: goto bPy0c; oI7yX: ONXns: goto aDc8M; MGQM_: $pwHmj = explode("\x2c", $this->data->set); goto bltGJ; Cf_b5: bC_VW: goto VyQjh; icHVH: if (empty($this->data->set)) { goto UY74s; } goto MGQM_; bSszQ: $Kl6Lw->save(); goto lT8wn; geF5c: $Kl6Lw->datecreated = time(); goto er05A; tXb8A: IT0fD: goto oB6NN; JS_MJ: vVPhW: goto aK6Y0; ItZmf: if (!($bLyFn == "\x61\x6c\151\x67\x6e\150\x6f\163\x74")) { goto xk4gC; } goto QgTML; lD00E: acVm_: goto jO7M7; wBQCj: $Kl6Lw = new ProductEvent(null); goto ygMjg; xC3zo: if (empty($this->data->set)) { goto acVm_; } goto cy0KV; XzBzb: foreach ($i8FMT as $sULbw) { goto At1Al; At1Al: $em9_L = new Product($sULbw); goto TDGzD; v8y7M: HcAzk: goto qfO0J; TDGzD: $em9_L->soft_delete(); goto v8y7M; qfO0J: } goto H7GTq; s44wz: if (empty($this->data->instanceid)) { goto aEs_6; } goto wWH31; hTDyP: $pwHmj = explode("\54", $this->data->set); goto HeyDQ; oBuL5: if (!($bLyFn == "\x61\x6c\151\x67\156\x65\156\144\144\141\164\145")) { goto bBvvj; } goto icHVH; i9gCb: $eJ2uc = new StdClass(); goto J2x1p; rsrnt: foreach ($pwHmj as $sULbw) { goto zdBIq; qVa2A: $FMMjV->host = $this->data->host; goto pMOzm; W2zsT: if (!($em9_L->contexttype == "\162\145\x67\151\x73\164\145\162\x65\x64\x5f\160\162\157\144\x75\x63\164")) { goto QzEGI; } goto K120i; EZJke: QzEGI: goto MKN2E; MKN2E: bQtbH: goto AmB7l; pMOzm: $em9_L->extradata = json_encode($FMMjV); goto mXtKI; zdBIq: $em9_L = new Product($sULbw, true); goto W2zsT; mXtKI: $em9_L->update(); goto EZJke; BmtNg: if ($FMMjV) { goto XGR5X; } goto nUebm; nUebm: $FMMjV = new StdClass(); goto YVg_I; K120i: $FMMjV = json_decode($em9_L->extradata); goto BmtNg; YVg_I: XGR5X: goto qVa2A; AmB7l: } goto mUtBH; Y22C8: $Kl6Lw->productid = $this->data->id; goto lytw2; BJjCJ: return new Product($this->data); goto eOMcq; Ttu6s: niW6p: goto gx0em; H7GTq: XXdZ4: goto Cf_b5; HeyDQ: foreach ($pwHmj as $sULbw) { goto kwmvN; RdUQE: if ($FMMjV) { goto PaQU1; } goto mW8uu; kgDU3: if (!($em9_L->contexttype == "\162\145\x67\x69\163\164\145\x72\145\144\137\x70\162\x6f\x64\x75\x63\x74")) { goto lGSpD; } goto FiaDZ; Y9LvB: $em9_L->update(); goto m9Q0N; r94uN: $FMMjV->otherhosts = $this->data->otherhosts; goto k4pQA; m9Q0N: lGSpD: goto BjHhX; k4pQA: $em9_L->extradata = json_encode($FMMjV); goto Y9LvB; kwmvN: $em9_L = new Product($sULbw, true); goto kgDU3; mW8uu: $FMMjV = new StdClass(); goto VLplI; VLplI: PaQU1: goto r94uN; FiaDZ: $FMMjV = json_decode($em9_L->extradata); goto RdUQE; BjHhX: DrldK: goto c2LLm; c2LLm: } goto JS_MJ; s9Fjw: CSDSQ: goto DphFS; qaRU6: Q4NoS: goto tD7SZ; eOMcq: TNQpR: goto V5nqb; RdZ2V: VrCO7: goto K8PCR; Z2isv: uQLa9: goto E04TQ; Y_EOa: $this->data->instanceid = $this->data->contextinstanceid; goto odAvh; lT8wn: goto cA7Lc; goto BJGGe; qu9It: $this->data->reference = shop_generate_product_ref($eJ2uc); goto PMFEV; mr23p: throw new \coding_exception("\x44\141\164\141\x20\x6d\165\x73\x74\40\142\145\x20\x72\145\x63\x65\151\166\x65\144\x20\x69\x6e\x20\143\157\x6e\164\162\157\154\x6c\145\x72\40\142\145\x66\157\162\145\40\x6f\160\145\162\x61\164\151\x6f\156\x2e\x20\x74\150\x69\x73\x20\151\163\40\141\40\x70\162\x6f\147\x72\141\155\x6d\x69\156\147\x20\x65\162\162\x6f\162\56"); goto RdZ2V; iVJ6O: $Kl6Lw = new ProductEvent(null); goto Y22C8; J2x1p: $eJ2uc->transactionid = 0; goto Ahbi1; mUtBH: YjeBp: goto hzsNk; zKo8M: $Kl6Lw->datecreated = time(); goto cqFAt; wWH31: $this->data->id = $this->data->instanceid; goto Y_EOa; odAvh: $DB->update_record("\x6c\157\143\x61\x6c\137\163\150\x6f\x70\x5f\160\162\157\144\x75\143\164", $this->data); goto iVJ6O; bPy0c: $this->data->instanceid = $this->data->contextinstanceid; goto T0Mni; dO2DF: foreach ($pwHmj as $sULbw) { goto K01qo; IiUTN: B6pRy: goto GFBeX; dVLfE: if (!isset($em9_L->{$this->data->type})) { goto RcjOe; } goto ZgZb1; xSBSm: $Fogge->{$this->data->name} = $this->data->value; goto LTztH; ZgZb1: $Fogge = json_decode($em9_L->{$this->data->type}); goto xSBSm; skH12: $em9_L->update(); goto vUpZT; vUpZT: RcjOe: goto IiUTN; LTztH: $em9_L->{$this->data->type} = json_encode($Fogge); goto skH12; K01qo: $em9_L = new Product($sULbw, true); goto dVLfE; GFBeX: } goto Z2isv; rafAg: foreach ($i8FMT as $sULbw) { goto mW2Dj; h27wC: zOVYe: goto z83yW; mW2Dj: $em9_L = new Product($sULbw); goto iV8oj; iV8oj: $em9_L->delete(); goto h27wC; z83yW: } goto oI7yX; cqFAt: $Kl6Lw->eventtype = "\165\160\144\141\164\145\x64"; goto bSszQ; PMFEV: kRG8d: goto s44wz; wPAOM: if (!($bLyFn == "\141\154\151\147\x6e\x73\x74\141\162\x74\144\141\164\x65")) { goto iW3b6; } goto xC3zo; AwPyF: if (!$this->data->set) { goto bC_VW; } goto XzBzb; cy0KV: $pwHmj = explode("\54", $this->data->set); goto GDvbf; juxRi: if (empty($this->data->set)) { goto t9Ai4; } goto rqpfA; E04TQ: t9Ai4: goto DKJAF; Dae64: bBvvj: goto ItZmf; aDc8M: Q0BxR: goto s9Fjw; er05A: $Kl6Lw->eventtype = "\155\141\x6e\165\x61\154"; goto QyDKB; CC2nV: global $DB; goto adWb1; rqpfA: $pwHmj = explode("\54", $this->data->set); goto dO2DF; A2JWL: BPFZU: goto lD00E; GDvbf: foreach ($pwHmj as $sULbw) { goto ZeQeu; ZeQeu: $em9_L = new Product($sULbw); goto umZKz; umZKz: $em9_L->startdate = $this->data->startdate; goto tldtj; Bk68U: Z5E0q: goto cYFcD; tldtj: $em9_L->update(); goto Bk68U; cYFcD: } goto A2JWL; vx75H: fJ1Gs: goto qaRU6; zLjf_: if (!$this->data->set) { goto Q4NoS; } goto frZtt; VyQjh: zX4_m: goto jYjUG; tD7SZ: SPf8P: goto wPAOM; adWb1: if ($this->received) { goto VrCO7; } goto mr23p; bc3I7: if (!$this->data->set) { goto Q0BxR; } goto rafAg; DKJAF: klbC3: goto M3h0P; ygMjg: $Kl6Lw->productid = $this->data->id; goto geF5c; M3h0P: if (!($bLyFn == "\145\x64\x69\x74")) { goto TNQpR; } goto jD_Dm; CnUpd: if (!($bLyFn == "\141\154\x69\147\156\157\x74\x68\145\162\x68\x6f\163\164\x73")) { goto niW6p; } goto iB_dF; T0Mni: $this->data->id = $DB->insert_record("\x6c\157\143\141\x6c\137\x73\x68\x6f\160\137\x70\x72\157\x64\165\x63\164", $this->data); goto wBQCj; QyDKB: $Kl6Lw->save(); goto pu9g9; gx0em: if (!($bLyFn == "\141\x6c\x69\x67\x6e\x6d\145\x74\141\x64\x61\x74\141")) { goto klbC3; } goto juxRi; jD_Dm: if (empty($this->data->generatereference)) { goto kRG8d; } goto i9gCb; oB6NN: UY74s: goto Dae64; K8PCR: if (!($bLyFn == "\144\x65\154\145\164\x65")) { goto CSDSQ; } goto bc3I7; iB_dF: if (empty($this->data->set)) { goto JZpiT; } goto hTDyP; h3wEA: xk4gC: goto CnUpd; frZtt: foreach ($i8FMT as $sULbw) { goto CSvZh; Pqz_H: $em9_L->soft_restore(); goto iplV4; iplV4: lCoMY: goto owpQl; CSvZh: $em9_L = new Product($sULbw); goto Pqz_H; owpQl: } goto vx75H; aK6Y0: JZpiT: goto Ttu6s; Ahbi1: $eJ2uc->catalogitem = new CatalogItem($this->data->catalogitemid); goto qu9It; A5xBV: $pwHmj = explode("\54", $this->data->set); goto rsrnt; bltGJ: foreach ($pwHmj as $sULbw) { goto gJO1E; knqmX: $em9_L->enddate = $this->data->enddate; goto rqOTk; rqOTk: $em9_L->update(); goto cj4dT; gJO1E: $em9_L = new Product($sULbw); goto knqmX; cj4dT: rAZrA: goto aIH6_; aIH6_: } goto tXb8A; hzsNk: PmQLf: goto h3wEA; jO7M7: iW3b6: goto oBuL5; QgTML: if (empty($this->data->set)) { goto PmQLf; } goto A5xBV; jYjUG: if (!($bLyFn == "\x73\x6f\146\x74\162\x65\x73\x74\157\162\x65")) { goto SPf8P; } goto zLjf_; DphFS: if (!($bLyFn == "\x73\x6f\146\164\x64\145\x6c\x65\164\x65")) { goto zX4_m; } goto AwPyF; V5nqb: } }
