<?php
/*   __________________________________________________
    |              on 2.0.12              |
    |__________________________________________________|
*/
 namespace local_shop; defined("\115\117\x4f\x44\x4c\x45\x5f\x49\x4e\124\x45\122\x4e\101\x4c") || die; require_once $CFG->dirroot . "\x2f\154\x6f\143\x61\154\57\163\150\x6f\x70\x2f\x70\162\157\x2f\x63\x6c\x61\x73\x73\145\x73\x2f\x50\141\x72\x74\156\145\162\56\x63\x6c\x61\x73\x73\56\160\x68\x70"; use StdClass; class PartnerDiscount extends Discount { protected $rules; public function check_applicability(&$qQ0hv = null) { goto zPeRJ; jFnvr: $syuG8->ratio = $this->ratio; goto flCWa; flCWa: $this->productiondata = $syuG8; goto jl7Xd; I3F5T: return false; goto XjbDz; XGAfv: JTlvC: goto Si0Ce; aQFs9: $syuG8 = new StdClass(); goto HALw0; Si0Ce: list($tJgGS, $ds4vR) = $this->identify_partner_and_source($qQ0hv); goto S7wO5; o8poC: $this->ratio = $this->rules[$ds4vR->partnerkey][$uZa3o]; goto aQFs9; dHfPD: if (array_key_exists($ds4vR->parnerkey, $this->rules)) { goto SNJY5; } goto TBtyC; TBtyC: return false; goto GlXFT; LioNN: if (array_key_exists($tJgGS, $this->rules[$ds4vR->partnerkey])) { goto KqOUd; } goto I3F5T; UiRtq: khW9V: goto dHfPD; WWixR: return false; goto XGAfv; GlXFT: SNJY5: goto LioNN; zPeRJ: $this->checked = true; goto KRDWp; KRDWp: $this->get_rules(); goto lVp8z; ujklX: return false; goto UiRtq; S7wO5: if (!(!$ds4vR || $tJgGS == '')) { goto khW9V; } goto ujklX; XjbDz: KqOUd: goto o8poC; lVp8z: if (!empty($this->rules)) { goto JTlvC; } goto WWixR; HALw0: $syuG8->source = $tJgGS; goto jFnvr; jl7Xd: return true; goto sAzVn; sAzVn: } public function preview_applicability() { global $SESSION, $USER; return false; } public function is_interactive_eligible() { return false; } public function is_interactive_verified() { return false; } protected function get_rules() { goto DBvHH; giUHy: zc1zR: goto aRDX1; OKnig: u2ej0: goto giUHy; SSUbi: foreach ($g4ZHx as $zb2og) { goto kJvu2; HdiEy: l3Z04: goto P7fKE; u7SMa: $sfupD = str_split($K28OT); goto D1kcu; kJvu2: list($kWos7, $K28OT, $p8Q9C) = explode("\174", $zb2og); goto u7SMa; AhcWq: l8JhM: goto HdiEy; D1kcu: foreach ($sfupD as $uZa3o) { $this->rules[$kWos7][$uZa3o] = $p8Q9C; W_TQD: } goto AhcWq; P7fKE: } goto OKnig; DBvHH: if (isset($this->rules)) { goto zc1zR; } goto dTugq; F6noV: $this->rules = []; goto SSUbi; dTugq: $g4ZHx = preg_split("\x2f\x5b\134\x73\54\135\53\57", $this->ruledata); goto F6noV; aRDX1: } protected function check_ruledata($lWyz5) { goto cWIhk; CbrT7: $VZzZu = []; goto k0D6q; rreId: return false; goto bkKVI; k0D6q: foreach ($coM6y as $zb2og) { goto q6jmj; qRymc: return get_string("\x64\151\163\x63\157\x75\156\164\145\162\x72\157\x72\x3a\156\157\164\x65\156\157\165\147\x68\141\x72\x67\x75\155\x65\156\164\163", "\x6c\157\143\141\154\x5f\163\x68\x6f\x70"); goto zkBqg; H1Dm9: if (empty($drPdi[1])) { goto eSgBq; } goto rOkmh; GD30M: if (is_numeric($drPdi[2])) { goto zYPSk; } goto BLO5X; EuEPD: JLRMk: goto H1Dm9; BKGvX: if ($this->check_source_code($drPdi[1])) { goto HL8SK; } goto YR_al; CmKwh: Gr9fg: goto xGuJx; UJPxx: DjaV7: goto NmTvw; sGfoM: if (!(count($drPdi) != 3)) { goto fvJO1; } goto qRymc; rOkmh: return get_string("\144\151\x73\143\157\x75\x6e\164\145\x72\x72\157\x72\72\145\x6d\x70\164\171\163\x6f\x75\162\x63\x65\x63\157\144\x65", "\x6c\x6f\x63\141\x6c\x5f\163\x68\157\x70"); goto JmYF4; YR_al: return get_string("\144\x69\163\143\x6f\x75\x6e\x74\145\x72\x72\157\162\72\x62\141\x64\x73\157\165\162\143\x65\x63\157\x64\145", "\x6c\157\x63\x61\154\137\163\x68\157\160"); goto pCrAh; RUqnP: zYPSk: goto UJPxx; rLeD2: thNDS: goto wMfGw; zkBqg: fvJO1: goto qGZMT; q6jmj: if (!empty(trim($zb2og))) { goto Gr9fg; } goto pwzOw; xGuJx: $drPdi = explode("\x7c", $zb2og); goto sGfoM; qGZMT: if (empty($drPdi[0])) { goto thNDS; } goto KuZZ6; pCrAh: HL8SK: goto GD30M; pwzOw: goto DjaV7; goto CmKwh; BLO5X: return get_string("\144\151\163\143\x6f\165\x6e\164\145\162\x72\157\x72\x3a\142\141\144\x72\141\164\x69\157\146\157\x72\155\x61\164", "\154\x6f\143\x61\154\x5f\x73\x68\x6f\x70"); goto RUqnP; wMfGw: if ($DB->record_exists("\x6c\157\143\x61\154\x5f\x73\150\157\x70\x5f\x70\141\162\x74\156\x65\162", ["\x70\141\162\164\156\x65\x72\x6b\x65\x79" => $drPdi[0]])) { goto JLRMk; } goto UfHv9; JmYF4: eSgBq: goto BKGvX; KuZZ6: return get_string("\x64\151\x73\143\x6f\x75\156\x74\x65\162\x72\157\x72\72\x65\155\160\164\171\x70\x61\x72\x74\x6e\x65\x72\x6b\145\x79", "\x6c\x6f\x63\x61\x6c\137\163\x68\157\x70"); goto rLeD2; UfHv9: return get_string("\144\151\x73\143\x6f\x75\156\164\145\x72\162\157\x72\x3a\142\x61\x64\160\141\162\x74\156\145\x72\x6b\145\x79", "\x6c\157\143\141\x6c\x5f\163\x68\x6f\160"); goto EuEPD; NmTvw: } goto VTcO0; VTcO0: BYsl1: goto rreId; J8Qw4: $coM6y = explode("\54", $lWyz5->ruledata); goto CbrT7; cWIhk: global $DB; goto J8Qw4; bkKVI: } protected function check_source_code($n_yNp) { goto TsZoL; FN2UO: $FbnHw = 0; goto xTXwm; rBS6n: iQUq2: goto q73uu; xTXwm: $uuUkf = 0; goto d5Sg0; TsZoL: $oZL2c = str_split($n_yNp); goto FN2UO; S8P5j: foreach ($oZL2c as $yYJZh) { goto c5tSE; N5OnT: Pc52m: goto iZdXc; iZdXc: kquNG: goto LNszq; LNszq: ouNIA: goto com2o; c5tSE: switch ($yYJZh) { case "\x45": goto v49Tt; v49Tt: if (!($uuUkf == 1)) { goto ZPgSC; } goto ghBwC; ghBwC: return false; goto SqwQH; T97KV: $uuUkf = 1; goto k2p_9; SqwQH: ZPgSC: goto T97KV; k2p_9: case "\x49": goto oFZ6R; gNW0s: $FbnHw = 1; goto C7uq_; eIVUx: JBtT_: goto gNW0s; yJFd2: return false; goto eIVUx; oFZ6R: if (!($FbnHw == 1)) { goto JBtT_; } goto yJFd2; C7uq_: case "\101": goto AAS8U; hDN5g: return false; goto sxRIn; fERxb: $p6cJW = 1; goto VMqbT; sxRIn: mM22j: goto fERxb; AAS8U: if (!($p6cJW == 1)) { goto mM22j; } goto hDN5g; VMqbT: default: return false; } goto N5OnT; com2o: } goto rBS6n; d5Sg0: $p6cJW = 0; goto S8P5j; q73uu: return $uuUkf || $FbnHw || $p6cJW; goto JfQXa; JfQXa: } protected function identify_partner_and_source($qQ0hv) { goto AVyzv; khPgQ: goto CLU5Y; goto dBZoU; rqaw2: CLU5Y: goto naKMU; P4Zoa: if (!($M3X2L = $DB->get_record("\x6c\157\143\141\154\137\163\150\157\160\137\160\x61\162\x74\156\x65\162", ["\143\165\x73\x74\x6f\x6d\145\x72\151\x64" => $qQ0hv->customerid]))) { goto szqDQ; } goto qh_KL; ijSM4: return ["\111", $ds4vR]; goto khPgQ; bXC8Q: if (empty($qQ0hv->partnerid)) { goto djFZX; } goto tHv5f; Se7wh: if ($qQ0hv->has_internal_items()) { goto XlfGV; } goto ijSM4; tHv5f: return ["\105", new Partner($qQ0hv->partnerid)]; goto dYc0d; AVyzv: global $DB; goto bXC8Q; dBZoU: XlfGV: goto wDCcG; dYc0d: djFZX: goto P4Zoa; wDCcG: return ["\101", $ds4vR]; goto rqaw2; qh_KL: $ds4vR = new Partner($M3X2L); goto Se7wh; HSETa: return ['', null]; goto I82Vr; naKMU: szqDQ: goto HSETa; I82Vr: } }
